Loading python3/3.12.1
  Loading requirement: intel-mkl/2023.2.0
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loading `train_dataloader` to estimate number of stepping batches.
/scratch/um09/hl4138/venvs/dmpnn-venv/lib/python3.12/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=11` in the `DataLoader` to improve performance.

  | Name            | Type               | Params | Mode 
---------------------------------------------------------------
0 | message_passing | BondMessagePassing | 227 K  | train
1 | agg             | MeanAggregation    | 0      | train
2 | bn              | Identity           | 0      | train
3 | predictor       | RegressionFFN      | 90.6 K | train
4 | X_d_transform   | Identity           | 0      | train
5 | metrics         | ModuleList         | 0      | train
---------------------------------------------------------------
318 K     Trainable params
0         Non-trainable params
318 K     Total params
1.273     Total estimated model params size (MB)
26        Modules in train mode
0         Modules in eval mode
/scratch/um09/hl4138/venvs/dmpnn-venv/lib/python3.12/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=11` in the `DataLoader` to improve performance.
Metric val_loss improved. New best score: 0.336
Metric val_loss improved by 0.053 >= min_delta = 0.0. New best score: 0.283
Metric val_loss improved by 0.061 >= min_delta = 0.0. New best score: 0.222
Metric val_loss improved by 0.030 >= min_delta = 0.0. New best score: 0.192
Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.182
Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.172
Metric val_loss improved by 0.025 >= min_delta = 0.0. New best score: 0.148
Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.137
Metric val_loss improved by 0.020 >= min_delta = 0.0. New best score: 0.118
Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.104
Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.099
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.098
Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.092
Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.089
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.089
Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.085
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.084
Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.082
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.081
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.080
Monitored metric val_loss did not improve in the last 30 records. Best score: 0.080. Signaling Trainer to stop.
/scratch/um09/hl4138/venvs/dmpnn-venv/lib/python3.12/site-packages/lightning/pytorch/trainer/connectors/checkpoint_connector.py:149: `.test(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.test(ckpt_path='best')` to use the best model or `.test(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.
Restoring states from the checkpoint path at /scratch/um09/hl4138/dmpnn/checkpoints/insulator/rep_0/best-epoch=53-val_loss=0.0805.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loaded model weights from the checkpoint at /scratch/um09/hl4138/dmpnn/checkpoints/insulator/rep_0/best-epoch=53-val_loss=0.0805.ckpt
/scratch/um09/hl4138/venvs/dmpnn-venv/lib/python3.12/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:425: The 'test_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=11` in the `DataLoader` to improve performance.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loading `train_dataloader` to estimate number of stepping batches.
/scratch/um09/hl4138/venvs/dmpnn-venv/lib/python3.12/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=11` in the `DataLoader` to improve performance.

  | Name            | Type               | Params | Mode 
---------------------------------------------------------------
0 | message_passing | BondMessagePassing | 227 K  | train
1 | agg             | MeanAggregation    | 0      | train
2 | bn              | Identity           | 0      | train
3 | predictor       | RegressionFFN      | 90.6 K | train
4 | X_d_transform   | Identity           | 0      | train
5 | metrics         | ModuleList         | 0      | train
---------------------------------------------------------------
318 K     Trainable params
0         Non-trainable params
318 K     Total params
1.273     Total estimated model params size (MB)
26        Modules in train mode
0         Modules in eval mode
/scratch/um09/hl4138/venvs/dmpnn-venv/lib/python3.12/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=11` in the `DataLoader` to improve performance.
Metric val_loss improved. New best score: 0.398
Metric val_loss improved by 0.116 >= min_delta = 0.0. New best score: 0.282
Metric val_loss improved by 0.019 >= min_delta = 0.0. New best score: 0.262
Metric val_loss improved by 0.050 >= min_delta = 0.0. New best score: 0.212
Metric val_loss improved by 0.020 >= min_delta = 0.0. New best score: 0.192
Metric val_loss improved by 0.027 >= min_delta = 0.0. New best score: 0.165
Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.151
Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.141
Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.134
Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.131
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.130
Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.124
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.123
Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.121
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.120
Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.117
Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.112
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.111
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.109
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.108
Monitored metric val_loss did not improve in the last 30 records. Best score: 0.108. Signaling Trainer to stop.
/scratch/um09/hl4138/venvs/dmpnn-venv/lib/python3.12/site-packages/lightning/pytorch/trainer/connectors/checkpoint_connector.py:149: `.test(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.test(ckpt_path='best')` to use the best model or `.test(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.
Restoring states from the checkpoint path at /scratch/um09/hl4138/dmpnn/checkpoints/insulator/rep_1/best-epoch=52-val_loss=0.1080.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loaded model weights from the checkpoint at /scratch/um09/hl4138/dmpnn/checkpoints/insulator/rep_1/best-epoch=52-val_loss=0.1080.ckpt
/scratch/um09/hl4138/venvs/dmpnn-venv/lib/python3.12/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:425: The 'test_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=11` in the `DataLoader` to improve performance.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loading `train_dataloader` to estimate number of stepping batches.
/scratch/um09/hl4138/venvs/dmpnn-venv/lib/python3.12/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=11` in the `DataLoader` to improve performance.

  | Name            | Type               | Params | Mode 
---------------------------------------------------------------
0 | message_passing | BondMessagePassing | 227 K  | train
1 | agg             | MeanAggregation    | 0      | train
2 | bn              | Identity           | 0      | train
3 | predictor       | RegressionFFN      | 90.6 K | train
4 | X_d_transform   | Identity           | 0      | train
5 | metrics         | ModuleList         | 0      | train
---------------------------------------------------------------
318 K     Trainable params
0         Non-trainable params
318 K     Total params
1.273     Total estimated model params size (MB)
26        Modules in train mode
0         Modules in eval mode
/scratch/um09/hl4138/venvs/dmpnn-venv/lib/python3.12/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=11` in the `DataLoader` to improve performance.
Metric val_loss improved. New best score: 0.359
Metric val_loss improved by 0.168 >= min_delta = 0.0. New best score: 0.191
Metric val_loss improved by 0.024 >= min_delta = 0.0. New best score: 0.167
Metric val_loss improved by 0.030 >= min_delta = 0.0. New best score: 0.137
Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.121
Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.104
Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.097
Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.092
Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.087
Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.079
Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.076
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.075
Monitored metric val_loss did not improve in the last 30 records. Best score: 0.075. Signaling Trainer to stop.
/scratch/um09/hl4138/venvs/dmpnn-venv/lib/python3.12/site-packages/lightning/pytorch/trainer/connectors/checkpoint_connector.py:149: `.test(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.test(ckpt_path='best')` to use the best model or `.test(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.
Restoring states from the checkpoint path at /scratch/um09/hl4138/dmpnn/checkpoints/insulator/rep_2/best-epoch=26-val_loss=0.0746.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loaded model weights from the checkpoint at /scratch/um09/hl4138/dmpnn/checkpoints/insulator/rep_2/best-epoch=26-val_loss=0.0746.ckpt
/scratch/um09/hl4138/venvs/dmpnn-venv/lib/python3.12/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:425: The 'test_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=11` in the `DataLoader` to improve performance.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loading `train_dataloader` to estimate number of stepping batches.
/scratch/um09/hl4138/venvs/dmpnn-venv/lib/python3.12/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=11` in the `DataLoader` to improve performance.

  | Name            | Type               | Params | Mode 
---------------------------------------------------------------
0 | message_passing | BondMessagePassing | 227 K  | train
1 | agg             | MeanAggregation    | 0      | train
2 | bn              | Identity           | 0      | train
3 | predictor       | RegressionFFN      | 90.6 K | train
4 | X_d_transform   | Identity           | 0      | train
5 | metrics         | ModuleList         | 0      | train
---------------------------------------------------------------
318 K     Trainable params
0         Non-trainable params
318 K     Total params
1.273     Total estimated model params size (MB)
26        Modules in train mode
0         Modules in eval mode
/scratch/um09/hl4138/venvs/dmpnn-venv/lib/python3.12/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=11` in the `DataLoader` to improve performance.
Metric val_loss improved. New best score: 0.363
Metric val_loss improved by 0.080 >= min_delta = 0.0. New best score: 0.283
Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.272
Metric val_loss improved by 0.062 >= min_delta = 0.0. New best score: 0.210
Metric val_loss improved by 0.048 >= min_delta = 0.0. New best score: 0.163
Metric val_loss improved by 0.028 >= min_delta = 0.0. New best score: 0.135
Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.118
Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.113
Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.109
Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.107
Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.104
Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.101
Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.096
=>> PBS: job killed: walltime 602 exceeded limit 600
[rank: 0] Received SIGTERM: 15
